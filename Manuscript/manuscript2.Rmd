---
title: "Detection of disease outbreaks from rare serotypes"
author: Massimo Cavallaro
date: "10 Mar 2021"
output:
  word_document:
    toc: True
bibliography: Bibliography.bib
# csl: american-physics-society.csl
---

<!-- # word_document -->

<!--     # number_section: True -->
<!-- #     pdf_document: -->
<!-- #         toc: True -->
<!-- #         number_sections: true -->
<!-- # header-includes: -->
<!-- #   - \usepackage{caption} -->
<!-- #   - \captionsetup[figure]{labelformat=empty} -->
author recommendion from DT (no order): Massimo Cavallaro, Derren Ready (sent data), Dan Todkill, Theresa Lamagni(GAS expert), Noel D. McCarthy, Matt J. Keeling

^1^ The Zeeman Institute for Systems Biology & Infectious Disease Epidemiology Research, University of Warwick, Coventry, CV4 7AL, United Kingdom.

^2^ School of Life Sciences and Mathematics Institute, University of Warwick, Coventry, CV4 7AL, United Kingdom.

^3^ Warwick Medical School, University of Warwick, Coventry, CV4 7AL, United Kingdom.

^4^ National Infection Service, Public Health England, Birmingham, B3 2PW, United Kingdom.

# Abstract

Detecting disease clusters over a background of endemic events is a key step for
shaping the intervention of public health authorities and directing their
outbreak containment efforts. This task is particularly challenging in severe
yet rare diseases, when only few cases are typically reported in a delimited
area and it is difficult to appreciate whether the local trend is worsening. To
address these situations, we propose an approach which aims at detecting
spatio-temporal aberrations from a Poisson point process and can be applied to
diseases caused by low-prevalence bacterial serotypes. As a case study,
we consider invasive Group-A Streptococcus infection events recorded by
Public Health England.

# Introduction

For decades, statistical principles and methods have been leveraged to identify
outbreaks of diseases and raise early warnings where necessary, thus
supplementing the health surveillance performed by physicians. The
effectiveness of these practices has been improved by the availability of large
digital databases, which can store many infection records and can be quickly
interrogated and processed [@Brookmeyer2004]. The importance of surveillance in
controlling the spread of diseases is highlighted by several recent challenges, ranging from the fast evolving COVID19 pandemic [@Alwan2020], to hospital-acquired
infections resistant to anti-microbial drugs [cite], to  the increase in chronic
non-communicable diseases [cite].
Surveillance is also important for diseases with low prevalence in the whole
population, but with exceptionally high severity for those who contracted.
The invasive Group-A Streptococcal (iGAS) disease is one of
these and is of particular concern for its global upsurge in the number of cases
[@Barnett2019]. Group-A Streptococcus, or *Streptococcus pyogenes*, is an
opportunistic Gram-positive human pathogen that is often found in the throat and on
the skin. Complex host-pathogen interactions in iGAS infections can cause a
broad range of symptom severity. Indeed, these bacteria can colonise parts of the body where
they are usually not found (such as the blood, the muscles, or the lungs) and
cause the so-called invasive infection, which requires hospitalisation and can even cause death.

Surveillance for new streptococcus serotypes (identified by their *emm* gene)
with increased virulence or for populations becoming susceptible to circulating
strains is a research priority. Only the rare, highly-severe cases can be
typically recorded; as a consequence, a high number of records of a certain
*emm* type can in principles result from an overall rare *emm* type that is very
likely to cause invasive infections, or a common *emm* type that only rarely
causes invasive infections.
The surveillance problem is to assess whether the recorded infections are from
an outbreak, which has the potential to grow if left unchecked, or are
consistent with an endemic baseline (and therefore of limited concern). To
this end,  we develop the Random Neighbourhood Scan (`RaNScan`), a numerical
method which can identify events violating the expected endemic dynamics in time
and space, and deploy our framework on typed iGAS infections recorded
in England.

The manuscript is organised as follows. In section 2 we introduce the outbreak-detection
principles and define the `RaNScan` approach, which is tested on simulated data
in section 3. In section 4 we introduce the serotyped iGAS data and derive the
endemic baseline for this disease. In section 5, `RaNScan` is applied to these
data and the detected clusters of outbreaks are discussed with the help of a
dimensionality reduction technique which allows us to conveniently visualise the
results. We conclude with a discussion in section 6.


# Null model and outbreak detection

A spatio-temporal disease pattern can be decomposed into two components, endemic
and epidemic -- although such a distinction can be blurred [cite]. The endemic
component explains a baseline rate of cases with a persistent yet stable
pattern, only reinforced by immigration [@Held2005]. The epidemic events can be
thought of as realizations of processes with auto-regressive or self-exciting
behavior, which arise from a common source, e.g., environmental exposure or
increased susceptibility in the population. In other words, the presence of
epidemic events are correlated with and reinforces the occurrence of successive
events [@Anderson1991]. Examples of epidemic phenomena beyond infectious
diseases are, e.g., earthquakes [@Ogata1988], crimes [@Mohler2011], forest fires
[@Vrbik2012], cascading failures [@Buldyrev2010], and invasion of ecosystems
[@Balderama2012].

We argue that the most important characteristic common to all epidemic data is
that single observations are not independent. Therefore, in order to state
whether events are observed in atypical numbers, our choice is to compare these
with the numbers expected if the events were uncorrelated in space and time.
As long as the recorded event counts are consistent with such a baseline, no
warning should be raised. This suggests that the first step of an outbreak
detection system is a naÃ¯ve inference of an arbitrary count process -- a *null
model* -- which does not take into account any spatial or temporal correlations.
As a second step, detecting deviations from such a pattern signals the presence
of epidemic behaviour.

We let $X(A)$ denote the random variable that describes the number of events in a
subset $A \subset  \mathcal{S}$ under the null model $X$ and
define a threshold value $\theta$ such that
$$
\mathrm{Prob}(X(A) > \theta) = \alpha.  \qquad (1)
$$
The basic exceedance criterion consists of triggering an investigation if the number $n$ of cases observed over $A$ exceeds $\theta$; $\alpha$ is the false-positive
detection rate, which is the probability of setting a warning by chance when no
outbreak is occurring, and the set $\mathcal{S}$ represents space, time, or both.
The approach described so far is not new [@Brookmeyer2004; @Unkel2012] and can be regarded as the
standard in statistical process control [@Woodall2006].

We assume that the null model is an inhomogeneous Poisson point process with
intensity $\lambda(x,y,t)$, where $x$ and $y$ are spatial coordinates and $t$
is the time. The functional parameter $\lambda$ is required to be locally
integrable and is not necessarily constant in space and time. Indeed, even in
the absence of epidemics, we may expect many episodes in highly populated
regions and in certain days of the year, as many diseases are known to be
influenced by seasonality and weekends or holidays can impact the
daily recording practice [@Morbey2015; @Colon-Gonzalez2019].
A Poisson point process in $\mathcal{S}$ is defined by the following two properties:

 1. $X(A_1)$ and $X(A_2)$ are independent for disjoint subsets $A_1$ and $A_2$ of $\mathcal{S}$;
 2. For any subset $A \subset \mathcal{S}$, $X(A)$ has Poisson distribution
  $$
  \mathrm{Prob}(X(A) = n) = \Lambda(A)^n  e^{-\Lambda(A)}/n!, \qquad (2)
  $$
  $$
  \Lambda (A) = \int_A \mathrm{d}\xi \, \lambda(\xi),
  $$

where $\xi=(x,y,t)$ and $\Lambda(A)$ is referred to as the intensity measure
[@Cox1980]. Given the intensity function, it is straightforward to numerically obtain
$\Lambda(A)$, find the $\alpha$th quantile $\theta$, and state whether the
observed number $n$ exceeds this value in the subset $A$.
Those subsets such that the observed
event number exceeds $\theta$ are tagged as outbreak subsets. For simplicity, it
is convenient to threat the time $t$ as an integer variable rounding it up to,
e.g., days or weeks, thus $\mathcal{S}$ is $\mathbb{R}^2\times \mathbb{N}$, its
generic subset $A$ is the union $\cup_{i\in \mathbb{N}} A_i$, $A_i = \{(x,y,t)
\in A |  t=i\}$, and the intensity measure can be easily computed as sum of
two-dimensional integrals, i.e., $\Lambda(A)=\sum_i\int_{A_i}\mathrm{d}x
\mathrm{d}y \lambda(x,y,i)$.

The intensity function $\lambda$ represents the average trend of the endemic
infections. We  assume that it  factorises into a spatial factor $\lambda_0$ and
a temporal factor $\lambda_{1}$, i.e.,  $\lambda(x,y,t) =
\lambda_0(x,y)\,\lambda_{\mathrm{time}}(t)$, thus excluding any correlation between the
space and time trends. $\lambda_0(x,y)$ is proportional to the population
density, reflecting the fact that the number of observed episodes in an
area increases with its population size. This arguably
is the most imporant factor in the spatial distribution of the episodes, although,
in large geographical areas, other factors such as the climatic zone could
affect the endemic baseline. The temporal factor encodes the disease seasonality
and other long term trends and can be obtained from fitting a periodic function.

The inequality (1) provides a basic exceedance criterion for flagging a
subset $A$ (which embraces a geographical region for a certain time interval)
but is far from being ideal.
Indeed, a warning is raised with probability $\alpha$ even if the data is actually generated by
the baseline model $X(A)$. Further, the size and the boundaries of the subsets
over which an outbreak can be defined must be taken into account as an outbreak
with low prevalence but diffused in a large area may be missed by small-$A$
settings [@Farrington2004].

To address these issues we consider, for each event
$\mathbf{x} \in \mathcal{S}$, $N$ overlapping subsets $A_i \subset \mathcal{S}$,
such that $\mathbf{x} \in A_i$, $i=1,\ldots,N$ and apply criterion (1) to each
one of them in order to test whether there is aberration from the baseline
Poisson point process (Fig. 1).

![Fig. 1 Representation of random neighbourhood scan on a square. **A** Black markers represent point events that are generated from an endemic baseline (blue shade). The number of event in any region (circles) is consistent with the endemic baseline prediction, within statistical fluctuations.  **B** Three point events (red markers) representing an unexpected outbreak are overlayed in the region delimited by the dashed line. Many circles in this region contain significantly more events than the baseline prediction and are flagged in red.](FigureMethod0.png){width=90%}

In the absence of any aberrations and in agreement with property 2, the number
of events in each subset $A_i$ has distribution (2) and, if its intensity
measures $\Lambda(A_i)$ are the same for all the subsets, there is a fraction
$\alpha$ of them where the observed number of cases exceeds the threshold
$\theta$. This suggests us to raise a warning for the event $\mathbf{x}$ if the
fraction $w(\mathbf{x})$ of flagged subsets is bigger than $\alpha$. We refer to
$w(\mathbf{x})$ as the *warning score*. In practice, it is hard to find $N$
subsets whose intensity measure is identical.
We instead opt to select cylinders of the same volume  $\int_A \mathrm{d}
\xi$, arguing that this choice is computationally  cheaper than the former
and, for large enough cylinders, their individual differences are smoothed out.
We also relax the requirement that $w(\mathbf{x}) > \alpha$ for an outbreak event and
stick to a continuous warning score $w(\mathbf{x}) \in [0,1]$.

To summarise, for a single infection case $\mathbf{x}$, this methods returns a warning
score $w(\mathbf{x})$  that measures to what extent its presence alters the
local count statistics from those of a Poisson point process of intensity
$\lambda$.

# Simulation study

<!-- Synthetic data are powerful resources for assessing a methodâs ability to -->
<!-- discern the latter from the former. -->

We assess the method's ability to discern baseline from outbreak data
by means of synthetic data. To this end, we assume the baseline intensity
$\lambda=\lambda_0(x,y)\lambda_{\mathrm{time}}(t)$ with
$$
\lambda_0(x,y) =  (C + D\,\mathrm{e}^{-E( (x-0.5)^2+(y-0.5)^2) }), \qquad (3)
$$
$$
  \lambda_{\mathrm{time}}(t) = (A/2 (\sin(t) + 1) +B)
$$
over a unit square region with parameters $(A,B,C,D)=(7,0.9,0.5,80)$ where $x$
and $y$ are spatial coordinates, while $t$ is the time index ranging from $1$ to
$20$. This describes a spatial distribution of cases peaked at the center of the
region, modulated by a periodic temporal trend. For each value of $t$ we
simulate a spatial Poisson point process with intensity $\lambda$, which yields
a random pattern of points representing endemic baseline episodes. An outbreak
in a delimited polygonal region is simulated by randomly generating additional
Poisson point events with intensity $50 \, \lambda_{\mathrm{time}}(t)$ for
$t=5,6,7,8, 15, 16, 17, 18$ and zero elsewhere. The resulting point pattern is
illustrated in Fig. 2A for the first $9$ time steps.

We then draw 1000 random cylinders of equal volume, with radia $\rho=(0.40,0.28,0.23,0.20,0.18)$ and height $h=(1,2,3,4,5)$.
The volume $\pi \rho^2 h \approx 0.5$ is subject to the constrain that a generic cylinder must contain in average
more than one baseline event. The centre coordinates are randomly sampled with replacement
from the episode locations and times and randomly shifted such that each cylinder contains
its assigned episode location.

The classification performed by the algorithm is summarised by the warning scores
which indeed appear to capture the synthetic outbreak, as illustrated
in Fig. 2B. Excellent performance is confirmed by the ROC curves (Fig. 3A)
and C-statistics (ROC-AUC 0.96, 95%CI 0.93-0.98 by means of bootstrap).

<!-- ![Fig. 3](Surveillance Methods/surveillance_3D_files/cylinder_plot.png) -->

![Fig. 2. Simulation experiment. **A** Synthetic baseline point events (black markers) for $1 \leq t \leq 9$. Additional events representing an outbreak (red markers) are in the areas delimited in red. **B)** Algorithm prediction. Episode markers are coloured by their warning scores, blue ($w=0$) to red ($w=1$). The algorithm assigns high warning scores to the events in the outbreak areas.](FigureMethod.png){width=110%}





![Fig. 3. ROC curve.](ROC.png){width=40%}

The warning scores obtained after increasing the volume of the cylinders by $40\%$ are
strongly correlated with the first replicate results (Pearson $\rho=0.92$,
P=$5\,10^{-65}$), thus suggesting that the result is robust to the choice of the cylinder size.

In a more realistic surveillance scenario,  the warning scores are updated
when new events are included into the dataset, which we take to occur at every
point $\tau$ in time. To simulate this, we iteratively apply the procedure
detailed above to the data until time $\tau$, $\tau=1,2,\ldots,20$ and observe
how the warning scores vary with $\tau$ (Fig. 4). For this simulation, the
values of $w(\mathbf{x})$ appear to converge after only one or two updates, which
suggests excellent timeliness.
However, it is worth noting that the timeliness can be influenced by the
outbreak type and its assessment requires comprehensive testing with different
outbreak scenarios [@Morbey2015; @Colon-Gonzalez2019].


![Fig. 4. Timeliness. As the time $\tau$ progresses and  new events and cylinders are added, the warning-score values of events  previously occurred (here at $t=5,6,7$, see also Fig. 2) are updated. In fact, these  converge quickly and even the earliest warning values are informative.](timeliness_.png){width=100%}


# Application to iGAS serotypes

An important part of the epidemiological surveillance of invasive GAS infections
is the typing of collected bacterial isolates. A widely used serotyping method
for GAS is based on the N-terminal part of the M-protein gene  (*emm*), which is
a highly polymorphic gene and allows us to distinguish clones of streptococcus
pyogenes which would otherwise look identical. So far, more than 200 *emm* types
have been identified in Europe and North America, with few common types
contributing to a high percentages of the total number of iGAS cases
[@Gherardi2018]. Streptococcal isolates of different *emm* types are thought of
belonging to different endemic populations and cannot form a single outbreak
even if when they occur in the same geographical location and at the same
time [@Barnett2019].

Our case-study cohort consists of $10\,820$ records of from $465$ different *emm*
types, with the three most prevalent types (viz., `1.0`, `89.0`, and `12.0`)
accounting for more than $38\%$ of all episodes, while other serotypes occur
one order of magnitude less frequently (Fig. 5). $235$ different *emm* types were
recorded only once in the cohort.

![Fig. 5. Relative frequency $\lambda_{\mathrm{m}}$ of selected *emm* serotypes in England computed retrospectively over the observation times $\tau$. **A** The fraction the total of three most common serotypes (viz., `1`, `89.01`, and `12.0`) is either overall declining or stable, yet they still account for more than $38\%$ of all episodes at the end of the study. **B** Selected *emm* types show concerning relative growth (`108.1` and `33.0`) or stable pattern (`44.0` and `94.0`) over the most recent years.](prevalence.png){width=90%}

The baseline intensity $\lambda_{\mathrm{M}}(x,y,t)$ specific to the *emm* type $M$
is obtained multiplying  $\lambda(x,y,t)$ by the the relative frequency $\lambda_{m}$ of $M$ in the
population, computed retrospectively until time $\tau$.
In other words, the null-model intensity function is assumed to obey
$$
\lambda_{\mathrm{M}}(x,y,t) = \lambda_{\mathrm{m}}\,\lambda_{0}(x,y) \, \lambda_{\mathrm{time}}(t).
$$
The time and spatial factors remain the same for all *emm* types. As the incidence of iGAS infection is subject to seasonality [@Efstratiou2016], $\lambda_{\mathrm{time}}(t)$ is chosen to be periodic with a period $T$ of one year, viz.,
$$
\lambda_{\mathrm{time}}(t|\vartheta_\tau) =  a + b\, t +(c + b \, t) \, \sin( 2 \pi d / T +  2 \pi t / T) 
$$
where $\vartheta_\tau := (a,b,c,d)$ are parameters that must be retrospectively estimated
from the data until time $\tau$. To this end, we use the principle of maximum
likelihood estimation (MLE). We denote by $t_1,t_2,\ldots,t_n$ the ordered times
of all events occurred until $\tau$, $0<t_1<t_2<\ldots<t_n<\tau$, regardless of
their *emm* types and geographical locations. The likelihood function
$L(\vartheta_\tau)$ under the Poisson null model is given by
$$
\log L(\vartheta_\tau) = - \int_0^\tau\lambda_{\mathrm{time}}(u|\vartheta_\tau) \mathrm{d}u + \sum_{i=0}^n\log \lambda_{\mathrm{time}}(t_i|\vartheta_\tau).
$$
The value of $\vartheta_{\tau}$ that maximises the likelihood is recursively
obtained by maximising over $a,c,d$ using the Nelder-Mead method
with $b$ held fixed, and then finding the global maximum over $b$
with the other parameters held fixed.
The temporal intensity function fitted to all data until the end of the study
is illustrated in Fig. 6. Interestingly, the fitted curve shows
an increasing trend over the whole period 
of study, except year 2020.

![Fig. 6 Weekly number of iGAS infection events (black solid line) and fitted temporal baseline function $\lambda_{\mathrm{time}}$ (dashed red line, shaded area comprises $95\%$ confidence interval). The overall fitted trend is increasing, despite the sharp drop in 2020.](time_factor.png){width=50%}


The episodes in the database are labelled by the patient postcode location.
For each postcode, the estimated population size is obtained from the
2011 Census in England and Wales by the Office for National Statistics (ONS),
which allows us to tabulate the values of the spatial baseline intensity $\lambda_0(x,y)$.
The corresponding spatial coordinates are taken to be the postcode centroid locations,
also retrieved from ONS.
This completes the definition of the endemic intensity function
$\lambda(x,y,t)$. The next step is to retrospectively seek aberrations from the
Poisson point process specified by $\lambda$.

# Cluster analysis and data-point embedding

Warning scores for all episodes of selected *emm* types are generated following
the procedure detailed in section 2, with $20000$ cylinders per *emm* type.
Their volumes are differentially set for each *emm* type, according to the
heuristic procedure of section 3, such that the rarer  the *emm* type, the
larger the cylinders' volumes.

In order to assess the results, we wish to show that `RaNScan`
consistently assigns high warning scores to neighbour events and is thus able to
reveal clusters of outbreaks. As each event is described by its spatial coordinates (e.g.,
latitude and longitude) and its date, the neighbourhood must defined in both
space and time. We use the t-distributed stochastic neighbour embedding (t-SNE)
method to place these events in a two-dimensional space in a way that preserves
neighbour identities [@Maaten2008].
Using a visualisation method based on neighboorhoods rather than on absolute
distances is very useful in our context, where the prevalence of each *emm* type
is important. Indeed, for *emm* types with low prevalence,
recorded episodes that are distant in space and time can be thought of being
part of the same outbreak, if this has been spreading fast. Conversely,
common *emm* types already established in the host population may show more
complex clustering structures on the same geographical area and time scale.
We illustrate the results for $4$ rare *emm* serotypes, viz.,
`94.0`, `108.1`, `44.0`, and `33.0`, and a common serotype, viz., `12.0`.

The *emm* type `94.0` amounts to $466$ invasive cases recorded over the
2015-2020 study period. Applying t-SNE to the episodes' spatial and temporal
coordinates yields the scatter plot of Fig. 7A, which shows a cluster of
episodes with high warning scores ($w>0.95$) in bright red. These events are
localised in both time (Fig. 7B) and space (Fig. 7C), and, specifically,
correspond to an outbreak in the town of Bournemouth (South West region) (Fig. 7D)
in 2017, well before the relative prevalence reached its plateau (Fig. 5B).
Fig. 7A also shows the presence of other clusters of cases in the North
West region, yet with $w < 0.95$, which might trigger investigations but are
not retrospectively tagged as of concern.

![Fig. 7. Data point embedding and cluster analysis for *emm* type `94.0`. **A** Each iGAS record, identified by its position in time and space, is embedded in a two-dimensional space of coordinates C~1~ and C~2~ according to the t-SNE method. The points are coloured by their warning scores (blue to red), thus showing the presence of a red bright cluster of points with high warning scores ($w>0.95$). Colouring the events by their record time **(B)** and region **(C)** shows that t-SNE preserves the neighbourhoods. **C** The highlighed cluster corresponds to events localised around the town of Bournemouth.](cluster_figures_94.png){width=100%}

The *emm* type `108.1` is rare ($270$ invasive cases recorded in total)
yet concerning, as its prevalence has been steadily increasing 
since 2018 (Fig. 5B). For this serotype, `RaNScan` raises many 
warnings as the expected baseline is lowered by the
absence of episodes prior 2018 (Fig. 8).
The clusters with the highest warning scores include episodes in South East
and South West, West Midlands, East Midland, and North West.
Interestingly, in Yorkshire and the Humber region, we detect the presence of
two clusters both localised in the city of Leeds but separated in time.
Further, another cluster localised around the river Humber is detected.

![Fig. 8 Data point emmbedding and cluster analysis for *emm* type `108.0`. Keys as in Fig. 7. emm `108.0` is a concerning type due to its recent increase in the number of cases. The many cases tagged with high warning scores **(A)** occurred after 2018 (**B**) and are clustered around several geographical locations (**C***-**D**).](cluster_figures_108.png){width=100%}



The *emm* type `44.0` totals only  $163$ recorded cases and its relative
prevalence is nearly constant in time, except for a small increase in mid-2019
(Fig. 5B). Consistently, `RaNScan` only detects a single outbreak of episodes
between March and August 2019 localised around the town of Chelmsford in the East of England (Fig. 9).

![Fig. 9 Data point emmbedding and cluster analysis for *emm* type `44.0`. ](cluster_figures_44.png){width=100%}

With a total of only $61$ invasive cases recorded, the *emm* type  `33.0` is one of
the rarest in the UK. Its relative prevalence has been linearly growing since
2019 (Fig. 5B). Similarly to `108.1`, `RaNScan` yields high warning score for
almost all events. t-SNE embedding shows that these belong
to a single cluster which corresponds to events diffused in central England (Fig. 10).

![Fig. 10 Data point emmbedding and cluster analysis for *emm* type `33.0`. Keys as in Fig. 7.](cluster_figures_33.png){width=100%}

On the other end of the spectrum, the *emm* type `12.0` is very common ($782$
cases over the study period) and its trend has been decreasing since mid-2016.
The application of `RaNScan` highlights very few points which might raise
concern with the majority of of the episodes being assigned low warning scores
and no event being assigned a warning score higher than $0.95$ (Fig. 11).

![Fig. 11 Data point emmbedding for *emm* type `12.0`.](cluster_figures_12.png){width=100%}




# Discussion

In this paper, we have developed `RaNScan` (Random Neighbourhood Scan), a
statistical method that identifies outbreaks by detecting deviations from a
baseline Poisson point process. It is based on a simple and scalable approach,
i.e., measuring the expected and observed number of cases in random portions
(viz., cylinders) of space and time. While the statistics in a single random
region are not highly informative, aggregating information over many random
regions permits the detection of infectious-disease clusters. A strength of this
approach is that it returns a warning score for each recorded episode. This
makes it ideal in application to diseases which are sparsely distributed, where
it is needed to assess a new health event as soon as it is recorded, rather than
waiting until enough cases are collected over a determined region or time
interval. `RaNScan` was applied to investigate outbreaks of invasive Group-A
Streptococcal disease (iGAS) in England.

Our method is akin to those based on the so-called scan statistics
[@Kulldorff1997]. They both rely on creating a large number of circular (for the
purely spatial case) or cylindrical (for the spatio-temporal scan
[@Kulldorff2001]) windows, each with a different set of events in it. The scan
statistics then consist of identifying the circle or cylinder with the highest
likelihood ratio, which corresponds to the region where an outbreak is most
likely to have occurred. Conversely, in `RaNScan`, randomly drawing many
cylinders around each event $\mathrm{x}$ permits defining a warning score $w$
specific to $\mathbf{x}$.

One potential limitation of our approach is that the values of the warning
scores depend on the chosen volumes  of the spatio-temporal sectors. The results
are also subject to fluctuations due to the random sampling of these sectors. In
fact, extensive simulations show that, performing replicates with different sector sizes, the results
remain consistent. The fluctuations can also be controlled by increasing the
sampling. We argue that these effects can be mitigated by continuously
varying the radia and the heights of all the cylinders, as in the methods based on
the scan statistics [@Kulldorff2001].

Retrospective validation was performed on simulated data using Receiver
Operating Characteristic (ROC) curves and c-statistics. The timeliness was
assessed by tracking how the individual warning scores vary as new-events are
included into the simulation study. Both gave excellent results. It is worth
noting that, in general, the timeliness can be influenced by the speed of the
outbreak growth [@Colon-Gonzalez2019]. In the absence of a definitive and comprehensive list of all
real outbreaks that should be detected by public-health surveillance, it is hard
to fully benchmark any surveillance method. Further work is planned to address
this point, including the use of a compilation of iGAS outbreaks identified
through a variety of consensus sources. In order to circumvents this latter
point and confirm that our method consistently detects clusters of diseases, we
proposed to visualise the data using t-distributed stochastic neighbour
embedding (t-SNE). This is a dimensionality reduction algorithm, which
highlights events proximal in both space and time and shows that the events with
high warning scores typically cluster together, thus suggesting that often these are not isolated cases.


# Funding Statement

This work was supported by Health Data Research UK, which is funded by the UK
Medical Research Council, EPSRC, Economic and Social Research Council,
Department of Health and Social Care (England), Chief Scientist Office of the
Scottish Government Health and Social Care Directorates, Health and Social Care
Research and Development Division (Welsh Government), Public Health Agency
(Northern Ireland), British Heart Foundation and the Wellcome Trust.

# Bibliography


